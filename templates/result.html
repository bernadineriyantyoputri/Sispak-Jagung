<!doctype html>
<html lang="id">
<head>
  <meta charset="utf-8">
  <title>Hasil Diagnosa</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">

  <style>
    body { background: #f5f7fa; }
    .card-result { border-left: 5px solid #0d6efd; }
  </style>
</head>

<body>

<nav class="navbar navbar-expand-lg navbar-dark bg-primary shadow-sm">
  <div class="container">
    <a class="navbar-brand" href="/">üåΩ Expert System | Jagung</a>

    <div>
      <a href="/" class="btn btn-light btn-sm">Home</a>
      <a href="/admin/rules" class="btn btn-light btn-sm ms-2">Rule Editor</a>
      <a href="/export/logs" class="btn btn-warning btn-sm ms-2">Export Logs</a>
    </div>
  </div>
</nav>

<div class="container mt-4">

  <div class="card shadow-sm">
    <div class="card-body">
      <h3>üîç Hasil Diagnosa</h3>

      {% if model_probs %}
        <h5 class="mt-4">Prediksi Model (Opsional)</h5>
        <ul>
          {% for k,v in model_probs.items() %}
            <li>{{ k }} : {{ "%.3f"|format(v) }}</li>
          {% endfor %}
        </ul>
      {% endif %}

      <h5 class="mt-4">Hasil Forward Chaining + Certainty Factor</h5>

      {% if results %}
        {% for r in results %}
          <div class="card card-result shadow-sm mt-3 p-3">
            <h4>{{ r.name }}</h4>
            <p class="text-muted mb-2">{{ r.description }}</p>

            <div><strong>Certainty Factor:</strong> {{ "%.4f"|format(r.cf) }}</div>

            <details class="mt-2">
              <summary class="text-primary" style="cursor:pointer;">Lihat Evidence</summary>
              <ul class="mt-2">
                {% for sk,sv in r.conditions_evidence.items() %}
                  <li>{{ sk }} ‚Üí {{ "%.4f"|format(sv) }}</li>
                {% endfor %}
              </ul>
            </details>
          </div>
        {% endfor %}
      {% else %}
        <div class="alert alert-warning mt-3">
          Tidak ada rule yang cocok. Coba tambahkan keyakinan gejala lain.
        </div>
      {% endif %}
    </div>
  </div>

</div>

</body>
</html>
